Kevin C. Chang
SQL2: Aggregates
CS411 Database Systems
• Aggregate
• Sum, Count, Max, Min, …
• Null values in aggregates
• Grouping
• Attributes after grouping
• Having clauses
• General form: Select‐From‐Where‐Group By‐Having
Concepts You Will Learn
SQL2: Aggregates (1 of 27)Default Section (1 of 1)
Why Do We Learn This?
SQL2: Aggregates (2 of 27)Why Do We Learn This? (0 of 1)
Q:  1) What is an “aggregate”? 
2) Why is it useful?
SQL2: Aggregates (3 of 27)Why Do We Learn This? (1 of 1)
Overview
SQL2: Aggregates (4 of 27)Overview (0 of 5)
• SUM, AVG, COUNT, MIN, and MAX can be applied to a column in a 
SELECT clause to produce that aggregation on the column.
• Also, COUNT(*) counts the number of tuples.
Aggregations
SQL2: Aggregates (5 of 27)Overview (1 of 5)
• From Sells(bar, beer, price), find the average price of Bud:
SELECT AVG(price)
FROM Sells
WHERE beer = ‘Bud’;
Example: Aggregation
SQL2: Aggregates (6 of 27)Overview (2 of 5)
•DISTINCT inside an aggregation causes duplicates 
to be eliminated before the aggregation.
•Example: find the number of different prices 
charged for Bud:
SELECT COUNT(DISTINCT price)
FROM Sells
WHERE beer = ‘Bud’;
Eliminating Duplicates in an Aggregation
SQL2: Aggregates (7 of 27)Overview (3 of 5)
