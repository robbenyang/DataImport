Semi-structured Data: 
Representation/Querying: 
XML/SOAP/JSON 
CS 411 Database Systems 
Mianwei Zhou 
Last Lecture: We learn about ... 
â€¢ What is Semi-Structured Data? 
â€¢ Why do we need Semi-Structured Data? 
â€¢ XML: Language for representing semi-
structure data. 
In this lecture, We will cover 
â€¢ What is Semi-Structured Data? 
â€¢ Why do we need Semi-Structured Data? 
â€¢ XML: Language for representing semi-
structure data. 
â€¢ JSON: Another popular semi-structure data 
language. 
â€¢ XPath/XQuery: Programing Language for 
Querying XML 
JSON: JavaScript Object Notation 
What is JSON? 
â€¢ JSON: stands for JavaScript Object Notation.  
â€“ A text-based open standard designed for human-
readable data interchange.  
â€“ Originally designed by Douglas Crockford. 
â€“ Extended from JavaScript scripting language. 
 
 
How does JSON looks like? 
{ 
â€œNameâ€: â€œYellowstone National Parkâ€, 
â€œLocationâ€: [  
{ 
â€œCountyâ€: â€œPark Countyâ€, 
â€œStateâ€: â€œWyomingâ€ },  
{ 
â€œCountyâ€: â€œGallatin Countyâ€,  
â€œStateâ€: â€œMontanaâ€ } 
], 
â€œCoordinatesâ€: { 
â€œLatitudeâ€: â€œ44Â°36â€² Nâ€, 
â€œLongitudeâ€: â€œ110Â°30â€² Wâ€ }  
} 
yellowstone.json 
JSON Application 1: 
JavaScript Data Structure  
<script language="javascript" > 
var JSONObj = { "name" : 
"tutorialspoint.com", "year" : 2005 }; 
document.write("<h3>Website 
Name="+JSONObj.name+"</h3>"); 
</script> 
A Piece of JavaScript Code 
JSON Application 2:Web Services use 
JSON to provide public data. 
Example: Facebook Graph Query 
https://developers.facebook.com/tools/explorer 
How is JSON different from XML? 
Difference 1: Data Type 
{ 
â€œNameâ€: â€œJohn Smithâ€, 
â€œidâ€: â€œjoin_smithâ€ 
â€œAgeâ€: 18,  
â€œAddress": {  
â€œStreet": "21 2nd 
Street",  
â€œCity": "New York",  
}  
} 
String 
<person> 
<name id = â€œjoin_smithâ€>   
John Smith </name> 
<age> 18 </age> 
<address>  
<street> 21 2nd Street 
</street> 
<city> New York</city> 
</address> 
</person> 
JSON has different data types 
XML does not have specific  data 
types. Values are all strings. 
String 
Number 
Object 
JSONâ€™s Basic Data Type 
â€¢ Number.    
â€“ â€œheight_in_meterâ€: 3 
â€¢ String (enclosed by double quotes): 
â€“ â€œnameâ€: â€œyellow stoneâ€ 
â€¢ Boolean (true/false): 
â€“ â€œIs_Public_Universityâ€: true 
â€¢ Null 
â€“ â€œageâ€: null 
 
JSONâ€™s Basic Data Type 
â€¢ JSON Object: an unordered collection of 
key:value pairs 
â€“ Example 
  
{ 
â€œCountyâ€: â€œPark Countyâ€, 
â€œStateâ€: â€œWyomingâ€ 
} 
Enclose
d by {} 
JSONâ€™s Basic Data Type 
â€¢ JSON Array: an ordered sequence of values, 
the values do not need to be of the same type. 
[ 
â€œNiceâ€, 
true, 
10, 
null 
... 
] 
Enclose
d by [ ] 
Objects Nested in Array 
[ 
{ 
â€œNameâ€: â€œYellowstone National Parkâ€, 
â€œIsNationalParkâ€: true 
}, 
{ 
â€œNameâ€: â€œTurkey Run State Parkâ€, 
â€œIsNationalParkâ€: false 
}, 
{ 
â€œNameâ€: â€œYosemite National Parkâ€, 
â€œIsNationalParkâ€: true 
} 
] 
Array Nested in Object 
{ 
â€œNameâ€: â€œYellowstone National Parkâ€, 
â€œLocationâ€: [  
{ 
â€œCountyâ€: â€œPark Countyâ€, 
â€œStateâ€: â€œWyomingâ€ },  
{ 
â€œCountyâ€: â€œGallatin Countyâ€,  
â€œStateâ€: â€œMontanaâ€ } 
] 
} 
Use 
Arrays 
in 
Objects 
Object Nested in Object 
{ 
â€œNameâ€: â€œYellowstone National Parkâ€, 
â€œCoordinatesâ€: { 
â€œLatitudeâ€: â€œ44Â°36â€² Nâ€, 
â€œLongitudeâ€: â€œ110Â°30â€² Wâ€  
}  
} 
Use 
Arrays 
in 
Objects 
Difference 2: Simpler & Smaller 
{ 
â€œNameâ€: â€œJohn Smithâ€, 
â€œidâ€: â€œjoin_smithâ€ 
â€œAgeâ€: 18,  
â€œAddress": {  
â€œStreet": "21 2nd 
Street",  
â€œCity": "New York",  
}  
} 
String 
<person> 
<name id = â€œjoin_smithâ€>   
John Smith </name> 
<age> 18 </age> 
<address>  
<street> 21 2nd Street 
</street> 
<city> New York</city> 
</address> 
</person> 
To represent the same amount of information, XML is 
usually larger than JSON. 
JSON does not have attributes 
JSON does not repeat tag names 
Summary 
â€¢ JSON â€“ Comparison with XML 
â€“ Use Data Types: Number, String, Boolean, null, 
object, array 
â€“ Less verbose 
â€“ Easy to be written by humans. 
We have learned how to represent semi-structured 
data: 
So, the next question will be how to query semi-
structured data. 
For Relational Database, we have SQL;  
For Semi-structure data, we have    ? 
A Movie XML File 
â€¢ movies.xml 
(https://dl.dropboxusercontent.com/u/35282
86/movie.xml) 
â€¢ Query Example 
â€“ How to list all the titles of movies? 
â€“ How to count the number of movies that are 
directed by each director 
â€“ The number of movies in each genre. 
â€“ ... 
XPath:  
Locate Elements/Attributes in XML 
â€¢ XPath: A simple language for describing sets 
of similar paths in a graph of semi-structured 
data. 
 
â€¢ Demo: http://www.zorba.io/ 
 
 
<Movie id="movie0"> 
    <Name>Patton</Name> 
    <Directed_By> 
         <Director id="director0">Franklin J. Schaffner</Director> 
    </Directed_By> 
    <Genres>    <Genre>Drama</Genre>     </Genres> 
    <Cast> 
         <Actor id="actor0"> 
              <Name>George C. Scott</Name> 
              <Gender>Male</Gender> 
         </Actor> 
   <Cast> 
</Movie> 
Directly using Tag Name is not good. 
Duplication 
Tree Structure Schema in XML 
<Movie id="movie0"> 
    <Name>Patton</Name> 
    <Directed_By> 
         <Director id="director0">Franklin J. 
Schaffner</Director> 
    </Directed_By> 
    <Genres>    <Genre>Drama</Genre>     
</Genres> 
    <Cast> 
         <Actor id="actor0"> 
              <Name>George C. Scott</Name> 
              <Gender>Male</Gender> 
         </Actor> 
   <Cast> 
</Movie> 
Movie 
Name 
Directed By 
Genres Cast 
Director Genre Actor 
Name Gender 
Each Node in the Tree can be Uniquely 
Identified by a Path 
Movie 
Name 
Directed By 
Genres Cast 
Director Genre Actor 
Name Gender 
Movie -> Cast -> Actor 
Movie -> Directed By -> 
Director 
Basic Design Principle  
of XPATH 
XPath:  
1. Specify XML Document 
â€¢ Syntax 
doc(file name) 
â€¢ Example: 
doc("https://dl.dropboxusercontent.com/u/35
28286/movie.xml"); 
XPath: 
2. Use path expressions to locate elements 
â€¢ Syntax 
ğ‘‡1 ğ‘‡2 ğ‘‡3 â€¦ 
â€¢ Example 
â€“ List all the movie names 
doc("https://dl.dropboxusercontent.com/u/3528286/mo
vie.xml")/W4F_DOC/Movie/Title 
â€“ List all the director names 
doc(" 
https://dl.dropboxusercontent.com/u/3528286/movie.x
ml ")/W4F_DOC/Movie/Directed_By/Director 
 
 
XPath: 
3. Find Attributes in Path Expression 
â€¢ Syntax 
ğ‘‡1 ğ‘‡2 ğ‘‡3 /â‹¯/@ğ´ 
â€¢ Example 
â€“ Listing the ids of all movies. 
doc("...")/W4F_DOC/Movie/@id 
â€¢ However, this does not work in Zorba, because 
Zorba requires the result should be XML. We 
should rewrite it as a XQuery: 
for $v in doc("...")/W4F_DOC/Movie/Cast/Actor/@id 
return <actor> {$v} </actor> 
XPath: 
4. Use Wildcards in Path Expressions 
â€¢ We can use * to match â€œany tagsâ€ 
â€¢ Example 
â€“ List both first name and last name of actors 
doc("https://dl.dropboxusercontent.com/u/3528286
/movie.xml ")/W4F_DOC/Movie/Cast/Actor/* 
â€“ List all the genres, 
Complete:  
doc(â€œ...")/W4F_DOC/Movie/Genres/Genre 
If I am lazy: 
doc(â€œ...")/*/*/*/Genre 
 
 
 
 
XPath: 
5. Use Conditions in Path Expression  
â€¢ Use [ ] to specify conditions. 
â€¢ Example 
â€“ List all movies that are released in 1980. 
 doc("...")/*/Movie[Year=1980]/Title 
â€“ List the first actor of each movie 
  doc("...")/*/ Movie/Cast/Actor[1] 
 
 
 
 
Does XPath have any 
limitation? 
Limitation of XPath: Cannot reorganize 
the results 
â€¢ XPath can only return parts of the target XML 
file. 
â€¢ XPath CANNOT reorganize the results 
â€“ Order the result, e.g. Order the movies by their 
released year. 
â€“ Aggregate the result, e.g., count the number of 
movies directed by each director. 
â€“ Join result, e.g., list the pairs of actors who have 
co-starred with each other in a movie. 
XQuery 
â€¢ XQuery: A query and functional programming 
language that is designed to query and 
transform collections and XML data. 
â€¢ Extended from XPath 
â€¢ SQL-Style Operations. 
How XQuery is related with SQL 
Name Year Genres 
Patton 1970 ... 
Whoâ€™s talking ... ... 
Movie Table XPATH: 
doc(â€œ...")/W4F_DOC/Movie/ 
<movie> 
<name> Patton </name> 
<year> 1970 </year> 
... 
</movie> 
<movie> ...</movie> 
Table Column 
Movie.Name 
Movie.Genres 
{$v/name} 
{$v/Genres/Genre} 
Use $v to name the records 
After the data is prepared, they can be 
handled by the same relational operations 
XQuery Syntax: 
1. For ... Return Clause 
â€¢ Syntax 
for variable in XPath 
return expression 
â€¢ Example 
List Movies and Their Directors 
 
 
for $v in doc("...")/*/Movie 
return <movie>{$v/Title} 
{$v/Directed_By/Director} </movie> 
XQuery Syntax: 
2. Where Clause 
â€¢ Syntax 
where condition 
â€¢ Example 
List Movies that are released 
before 1970 
 
 
for $v in doc("...")/*/Movie 
where $v/Year<1970 
return <movie>{$v/Title} {$v/Year} 
</movie> 
XQuery Syntax: 
3. Let Clause 
â€¢ Syntax 
let variable:= expression 
â€¢ Example 
List Movies that are released 
before 1970 
 
 
let $movies := doc("...")/*/Movie 
for $v in $movies 
where $v/Year<1970 
return <movie>{$v/Title} {$v/Year} 
</movie> 
XQuery Syntax: 
4. Join two data sources 
â€¢ Example 
List all the movies that have the 
same director with â€œ'Godfather, Theâ€ 
let $movies := doc("...")/*/Movie  
for $v0 in $movies 
for $v1 in $movies 
where $v0/Title='Godfather, The' 
and 
$v0/Directed_By/Director=$v1/Dire
cted_By/Director 
return $v1/Title 
XQuery Syntax: 
5. Group By ... Order By ... Clause 
â€¢ Syntax 
Group by variable Order By variable  
â€¢ Example: Order directors by the 
number of their movies. 
 for $v in doc("...")/*/Movie 
let $d := $v/Year 
group by $d 
order by count($v) 
return 
<p><Year>{$d}</Year><Num_of_Movie
>{count($v)}</Num_of_Movie></p> 
XQuery have other operators  
â€¢ Elimination of Duplicates (Corresponding to 
DISTINCT in SQL) 
â€“ Syntax: distinct-values(*) 
â€¢ Quantification in XQuery (Corresponding to 
ANY, SOME, IN in SQL 
â€“ Syntax:  
every variable in expression1 satisfies expression2 
some variable in expression1 satisfies expression2 
â€¢ Refer to the textbook for more details! 
 
 
Exercise: List the pairs of actors who have 
co-started with each other in one movie. 
â€¢ Answer? 
Exercise: List the pairs of actors who have 
co-started with each other in one movie. 
â€¢ Answer: 
 
for $v in 
doc("https://dl.dropboxusercontent.com/u/352
8286/movie.xml")/W4F_DOC/Movie 
for $a1 in $v/Cast/Actor 
for $a2 in $v/Cast/Actor 
where $a1/@id<$a2/@id 
return <co-star>{$a1} {$a2}</co-star> 
Summary 
â€¢ What we have learned 
â€“ JSON 
â€“ XPATH 
â€“ XQUERY 
 
Thanks! 
